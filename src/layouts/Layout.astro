---
import '~/assets/css/main.css'
import Banner from '~/components/Layout/Banner.astro'
import ThemeTransition from '~/components/Layout/ThemeTransition'
import i18next, { t } from 'i18next'
import Footer from '~/components/Layout/Footer/Footer.astro'
import Header from '~/components/Layout/Header/Header.astro'
import HeadSEO from '~/components/HeadSEO.astro'
import BackToTop from '~/components/Layout/BackToTop'
import { localizeUrl } from 'astro-i18next'
export interface Props {
    pageNamespace: string
}

// Copied from HeadHrefLangs
const supportedLanguages = i18next.languages
const currentUrl = Astro.url.href

const { pageNamespace } = Astro.props
const pageT = (key: string) => t(key, { ns: pageNamespace })
---

<!DOCTYPE html>
<html lang={i18next.language}>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />
        <title>
            {t('titleTemplate', { ns: 'common', title: pageT('seo.title') })}
        </title>
        {
            !Astro.params.slug &&
                // Copied from HeadHrefLangs
                supportedLanguages.map((supportedLanguage) => (
                    <link
                        rel="alternate"
                        hreflang={supportedLanguage}
                        href={localizeUrl(currentUrl, supportedLanguage)}
                    />
                ))
        }
        <HeadSEO
            title={pageT('seo.title')}
            description={pageT('seo.description')}
            image={{
                url: pageT('seo.ogImage'),
                alt: pageT('seo.ogImageAlt'),
            }}
        />
        <script>
            console.log('Hi there!')
            console.log('What are you looking for?')
            console.log('Just have a look at the source code ;)')
            console.log(
                'https://github.com/florian-lefebvre/portfolio/tree/v5/astro'
            )
            console.log('Built with Astro and Tailwind CSS')
            console.log('--------')
        </script>
        <script>
            ;(function () {
                try {
                    let mode = localStorage.getItem('theme')
                    let supportDarkMode =
                        window.matchMedia('(prefers-color-scheme: dark)')
                            .matches === true
                    const html = document.querySelector('html')
                    if (!mode && supportDarkMode) html?.classList.add('dark')
                    if (!mode) return
                    if (mode === 'dark') {
                        html?.classList.add('dark')
                    }
                } catch (e) {}
            })()
        </script>
    </head>
    <body class="bg-neutral-2 text-neutral-12 dark:bg-neutralDark-4">
        <Banner enabled={true} />
        <Header />
        <main>
            <slot />
            <BackToTop client:load />
        </main>
        <Footer />
        <ThemeTransition client:load />
    </body>
</html>
