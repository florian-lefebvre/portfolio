---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import Section from "~/components/Section";
import { components } from "~/components/mdx";

const testimonials = await Promise.all(
  (await getCollection("testimonials")).reverse().map(async (e) => ({
    ...e,
    ...(await e.render()),
  }))
);

const id = "testimonials";
---

<Section {id}>
  <Section.Title {id}>Testimonials</Section.Title>
  <div class="grid grid-cols-1 mt-4 gap-8">
    {
      testimonials.map(({ data, Content }) => (
        <div class="flex space-x-4">
          <Image
            src={data.image}
            alt=""
            class="h-20 w-20 rounded-full bg-bg-subtle border border-border shrink-0"
            width={80}
          />
          <div>
            <h3 class="mb-1 font-semibold text-text underline underline-offset-2">
              <a href={data.href} target="_blank">
                {data.title}
              </a>
            </h3>
            <p class="text-sm">{data.subtitle}</p>
            <p class="mt-3">
              <Content {components} />
            </p>
          </div>
        </div>
      ))
    }
  </div>
</Section>
