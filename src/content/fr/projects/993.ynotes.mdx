---
title: "yNotes: client non officiel d'ENT"
description:
    '"Accédez à vos notes, devoirs, emplois du temps et plus encore dans une
    interface élégante. élégante."'
thumbnail:
    url: /images/content/en/projects/ynotes-0.png
    alt: Différents appareils fonctionnant avec yNotes. Par Josselin Robert
category: Open Source
tags:
    [
        Education,
        Open Source,
        Mobile,
        Développement,
        Cross-platform,
        Flutter,
        Dart,
        yNotes,
    ]
---

## Introduction

yNotes (mauvais jeu de mot _"Why not?"_, _pourquoi pas ?_, que presque aucun
élève français n'a compris, crédits à [Josselin Robert](https://jsonlines.fr/))
est un client non officiel pour les _ENTs_ français (Espace Numérique de
Travail).

Il permet aux élèves d'utiliser les fonctionnalités "de base" fournies par
n'importe quel ENT (notes, devoirs, calendrier...) et ajoute des fonctionnalités
utiles sans rien stocker sur un serveur tiers. Les données restent sur
l'appareil.

Mon rôle dans ce projet open-source a quelque peu évolué :

-   En octobre 2020, j'ai retravaillé le site web et participé à la conception
    des interfaces de l'application mobile
-   En janvier 2021, j'ai de nouveau retravaillé le site web
-   J'ai commencé à contribuer au développement en lui-même vers juin 2021, en
    mettant en place un véritable _design system_ pour renforcer la cohérence
-   Je suis ensuite devenu _maintainer_ de septembre 2021 à février 2022

Nous avons utilisé des technologies intéressantes pour développer l'application
:

-   Pour l'application elle-même : [Flutter](https://flutter.dev) et
    [Dart](https://dart.dev)
-   Pour les déploiements :
    [GitHub Actions](https://github.com/features/actions) et
    [Fastlane](https://fastlane.tools/)
-   Pour le site web: [Nuxt](https://nuxtjs.org/), [Vue](https://vuejs.org/) et
    [Tailwind CSS](https://tailwindcss.com/)

Vous pouvez trouver le code source sur
[GitHub](https://github.com/EduWireApps/ynotes) et jeter un coup d'œil au projet
sur le [site web](https://ynotes.fr).

Découvrez cette superbe bande-annonce réalisée par Josselin !

<div class="aspect-w-16 aspect-h-9">

<iframe
    src="https://www.youtube-nocookie.com/embed/vqKXYIPjY8Q"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    class="w-full"
></iframe>

</div>

## Objectif

Le 21 janvier 2020, [Josselin Robert](https://github.com/JsonLinesCode) effectue
[le premier commit](https://github.com/EduWireApps/ynotes/commit/ca44fea8ee2b121f7221f6c26e78aab52f1567bb)
sur le repository GitHub. C'était censé être un mode sombre pour [EcoleDirecte]
(https://ecoledirecte.com), l'ENT le plus utilisé dans les écoles privées en
France.

Petit à petit, il s'est transformé en une alternative complète (et meilleure)
aux les 2 ENT les plus utilisés : EcoleDirecte et [Pronote]
(https://www.index-education.com/fr/logiciel-gestion-vie-scolaire.php).

Voici quelques maquettes tirées de nos fichiers Figma :

![Page des notes v1. Par Josselin Robert](/images/content/en/projects/ynotes-1.png)
![Page des notes v2.5. Par Josselin Robert et Florian Lefebvre](/images/content/en/projects/ynotes-2.png)
![Slides d'intro (parallax horizontal, transition fluide). Par Florian Lefebvre](/images/content/en/projects/ynotes-3.png)

## Focus : API interne

Je pense que la chose la plus impressionnante que nous ayons réalisée avec
yNotes est la mise en place d'une excellente API interne. Ou presque !

La plupart des problèmes que nous rencontrons actuellement sont sur le point
d'être corrigés par la version `v0.15`. Enfin, quand elle sortira... (mais j'en
parlerai un peu plus tard).

Voici plusieurs sujets liés à l'API interne :

### Travailler avec des API inconnues

Comme yNotes est une application non officielle d'ENTs, elle s'appuie sur des
des APIs qui ne sont pas documentées. La seule façon de savoir comment interagir
avec elles est de regarder les requêtes faites dans l'onglet "Réseau" du
navigateur. Ce n'est certainement pas la façon la plus simple de construire une
application qui est déjà complexe en elle-même.

### Gérer différentes structures de données

Il s'agit d'un problème courant pour les applications/services qui servent
d'interface avec différents services. Dans ce cas, vous devez créer une
interface appropriée pour tous les services.

Dans notre cas, les mêmes données sont stockées par les ENTs (note, devoir,
matière...) mais structurées différemment, et aussi sans tout à fait les mêmes
informations.

La création d'une interface qui peut _scale_ est difficile et nous avons mis
longtemps pour y parvenir. Mais la `v0.15` vise à corriger cela en fournissant
une interface unifiée aux services et aux modèles. Plus d'informations à ce
sujet dans la prochaine partie !

### Coder de façon à _scale_

Josselin a fait beaucoup de travail et c'est vraiment génial ! Mais quand la
base de code s'agrandit, il semble que les différentes partie de l'app manquent
d'unité... et cela devient difficile à maintenir.

Encore une fois, j'ai l'impression que c'est normal quand je repense à
l'histoire de l'application. Il a dû apprendre à utiliser Flutter, tout faire
par lui-même en essayant d'atteindre la parité des fonctionnalités, ce n'est pas
une tâche facile !

Mais prenons deux exemples qui expliquent pourquoi il fallait la remanier en
profondeur :

#### Design cohérent

À un moment donné, nous avons décidé de mettre à jour l'identité de
l'application en changeant sa couleur principale. Jusqu'à présent, tout allait
bien. Mais les couleurs _hardcodées_ étaient omniprésentes, ce qui rendait très
difficile une simple mise à jour de l'identité visuelle.

De plus, de nombreux boutons étaient _presque_ les mêmes... Parce qu'il y avait
de nombreux widgets ici et là.

C'est pourquoi, comme première tâche, j'ai décidé de travailler sur un système
de conception. Je n'ai pas écrit _tout_ à la main (en utilisant Dart paint) mais
j'ai créé des widgets cohérents et cohérents et centralisés basés sur Material
UI.

Voici le [repository](https://github.com/EduWireApps/ynotes-packages).

#### Et un ENT de plus...

Le 11 novembre 2021, [Nathan Codes](https://github.com/ItsNathand) soumet une
[PR](https://github.com/EduWireApps/ynotes/pull/115) qui ajoute un nouveau
service (nouvel ENT supporté). Et nous avons rapidement réalisé que nous allions
être confrontés à d'énormes d'intégration à la base de code.

La raison en est assez simple, regardez ceci (ce n'est pas un vrai exemple) :

```dart
final List<Homework> homework = api.type == "pronote" ? api.homework : []
```

C'est un peu caricatural mais c'est l'idée : beaucoup trop _hardcodé_.

### Stockage des données

Because of its unofficial nature, data had to be stored locally. For
configuration and authentication data, we used
[flutter_secure_storage](https://pub.dev/packages/flutter_secure_storage). For
the rest of the data, we used [Hive](https://pub.dev/packages/hive) (NoSQL
database) since we didn't really needed relationships. Unfortunately, Hive
doesn't support multi isolates access (multi threading in dart) for foreground
and background concurrent access which was leading to database corruptions. We
made some dirty fixes like reset the database, but ultimately we wish we could
use [Isar](https://pub.dev/packages/isar) but we had to many issues with it (for
instance it doesn't support 32bit devices).

En raison de son caractère non officiel, les données devaient être stockées
localement. Pour les données de configuration et d'authentification, nous avons
utilisé
[flutter_secure_storage](https://pub.dev/packages/flutter_secure_storage). Pour
le reste des données, nous avons utilisé [Hive](https://pub.dev/packages/hive)
(base de données NoSQL) car nous n'avions pas vraiment besoin de relations.
Malheureusement, Hive ne supporte pas l'accès à plusieurs _isolates_ (multi
threading dans Dart) pour l'accès simultané en premier plan et en arrière-plan,
ce qui entraînait des corruptions de la base de données. Nous avons effectué
quelques corrections _"hacky"_ comme la réinitialisation de la base de données,
mais en fin de compte, nous aurions souhaité pouvoir utiliser
[Isar](https://pub.dev/packages/isar) mais nous avons eu trop de problèmes avec
(par exemple, il ne supporte pas les 32 bits).

<Alert>

**EDIT**

Le support 32bit a été ajouté depuis que j'ai écrit les lignes ci-dessus, il est
donc enfin viable de migrer vers Isar !

</Alert>

## Etat actuel

C'est... compliqué.

yNotes est actuellement dans une phase étrange. Quelques dates pour comprendre
pourquoi :

-   **Septembre 2021** : Josselin arrête de travailler sur l'application pour se
    concentrer sur ses études et je deviens mainteneur (et seul contributeur
    actif)
-   **Novembre 2021** : Je commence à travailler sur la `v0.15`, censée corriger
    tous les problèmes mentionnés ci-dessus et plus encore
-   **Février 2022** : J'arrête de travailler sur yNotes en raison de sa
    complexité croissante, des risques juridiques et du temps que cela me prend

En avril 2022, nous avons décidé de mettre yNotes en pause (non maintenue), sans
publier la `v0.15` parce qu'elle était loin d'être prête (manque de support
32bit par Isar, seulement EcoleDirecte était implémenté, et que les notes...)

Depuis lors, de nombreuses personnes souhaitent que nous puissions encore
maintenir yNotes et nous le souhaitons également. L'application résout de vrais
problèmes, comme nous pouvons le voir avec ses utilisateurs de plus en plus
nombreux. Mais pour l'instant, elle est en pause.

Cependant, je vous encourage à consulter le
[code](https://github.com/EduWireApps/ynotes/tree/release/v0.15.0) de la `v0.15`
pour une raison très simple : il est pas mal. Je veux dire, en lisant mon code,
la documentation que j'ai faite, je me suis senti impressionné par mon travail 1
an après. _Etrange sensation..._

## Enseignements tirés

Ce projet m'a appris beaucoup de choses compte tenu de la quantité de choses sur
lesquelles j'ai travaillé :

-   Améliorer mes compétences avec Nuxt et Tailwind CSS
-   Améliorer mes compétences UI/UX en travaillant sur Figma et en ayant de
    vrais feedbacks
-   Apprendre Dart et Flutter
-   Améliorer l'analyse des requêtes du navigateur
-   Construire un code robuste et évolutif
-   Améliorer mes compétences en gestion de projet
-   Collaborer avec d'autres développeurs et non-développeurs

Je pense que Josselin a fait un excellent travail en choisissant l'outil pour
construire yNotes. Flutter est génial pour construire des applications
multiplateformes (nous avons même commencé à travailler sur des versions pour
Windows, Linux et MacOS !) et offre vraiment une bonne DX. Je regrette juste de
ne pas pouvoir d'utiliser Tailwind CSS, ce framework a vraiment changé ma façon
de coder les interfaces.

Ce projet m'a encouragé à travailler sur mon propre ENT, voir
[op-ent](/fr/projets/op-ent).
